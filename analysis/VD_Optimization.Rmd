---
title: "Variety Development Process Optimization"
author: "Wolfemd, LucianoRogerio"
date: "2021-09-16"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Introduction

  We are simulating the expected genetic gains of IITA Breeding Scheme for their selection index to use as burn-in sim:
  
<br />

| logFYLD | HI  | DM  | MCMDS | logRTNO | logDYLD | logTOPYLD | PLTHT |
| :-----: | :-: | :-: | :---: | :-----: | :-----: | :-------: | :---: |
| 20x     | 10x | 15x | -10x  | 12x     | 20x     | 15x       | 10x   |
|         |     |     |       |         |         |           |       |
  
<br />  
  
  Marnin estimated the [genetic and error variances](https://wolfemd.github.io/IITA_2021GS/inputsForSimulationV2.html#Conclusions) for each trial type (CET, PYT, AYT, and UYT)
  
## Prepare the Singularity Image to run the Simulations on BioHPC servers

The steps to create the singularity image with all the required packages are described at this [link](SingularityIm.html).
  

### Breeding Scheme Simulations parameters

  The burn-in simulation were replicated 20 times, simulating a 26 cycles of operations with the burn-in of the first 20 cycles.

<br />

| Sim Parameter      | Value  |     | Genetic Parameter | Value  |     | Variances Parameters | Value  |
| :----------------: | :----: | :-: | :---------------: | :----: | :-: | :------------------: | :----: |
| nTrainPopCycles    | 4      |     | NChr              | 18     |     | genVar               | 1,500  |
| NYrsAsCandidates   | 2      |     | effPopsize        | 200    |     | gxeVar               | NULL   |
| maxTrainingPopSize | 1000   |     | segSites          | 1,650  |     | gxyVar               | 1,500  |
| stageToGenotype    | CET    |     | nQTL              | 1,000  |     | gxlVar               | 750    |
| nParents           | 100    |     | nSNP              | 500    |     | gxyxlVar             | 300    |
| nCrosses           | 400    |     |                   |        |     | meanDD               | 0.23   |
| nProgeny           | 25     |     |                   |        |     | varDD                | 0.05   |
| nClonesToNCRP      | 3      |     |                   |        |     | relAA                | 0.5    |
| phenoF1toStage1    | FALSE  |     |                   |        |     | errVarPreStage1      | 17,500 |
|                    |        |     |                   |        |     |                      |        |
  
<br />  

## Breeding Schemes scenarios

### IITA breeding Scheme
```{r message=FALSE, warning=FALSE}
library(tidyverse); library(reactable)
IITAScheme <- read.table(here::here("data", "baselineScheme - IITA.csv"),
                         sep = ";", dec = ".", header = T)
IITAScheme %>% reactable()
```

Simulations for IITA [breeding Scheme](IITABS.html)

### IITA 1ยบ alternative breeding Scheme (Five years VDP)
```{r message=FALSE, warning=FALSE}
library(tidyverse); library(reactable)
IITAScheme <- read.table(here::here("data", "baselineScheme - IITA - NVDP1.csv"),
                         sep = ";", dec = ".", header = T)
IITAScheme %>% reactable()
```

Simulations for IITA [1ยบ alternative breeding Scheme](NVDP1.html) (Five years VDP)

### IITA breeding Scheme 2ยบ alternative (Four years VDP)
```{r message=FALSE, warning=FALSE}
library(tidyverse); library(reactable)
IITAScheme <- read.table(here::here("data", "baselineScheme - IITA - NVDP2.csv"),
                         sep = ";", dec = ".", header = T)
IITAScheme %>% reactable()
```

Simulations for IITA [2ยบ alternative breeding Scheme](NVDP2.html) (Four years VDP)




### Simulations of IITA Breeding Scheme with clones selected as parent from different years as candidate

Scripts at this [link](1-3YrsIITABS.html)
